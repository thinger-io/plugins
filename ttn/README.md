# TTN Stack 

<p align="center">
  <img src="assets/ttn-logo.png" style="height: 120px" alt="The Things Network logo">
</p>

The Things Network (TTN) is an open, community‑driven LoRaWAN® network that simplifies the deployment of large‑scale IoT solutions across the globe.

From Thinger.io we aim to provide TTN users with seamless integration tools for storing, analysing and visualising device data.

This plugin brings TTN traffic into Thinger.io through the **Products** feature, enabling automatic provisioning of devices and data buckets, together with fully customisable uplink and downlink processing logic.

> **Warning**  
> Please note that implementations made with versions higher than 2.0.0 of this plugin are not compatible with previous implementations.

## Getting Started

> **Prerequisite**  
> Devices within the selected TTN Application must be **homogeneous**—same type and model—so that autoprovision can assign the correct product template.

1. **Install the plugin** inside your Thinger.io account.  
   See the guide **“How to install a plugin”** on the Marketplace if you are not familiar with the process.

---

## Plugin Configuration

Open the plugin settings page. In the **Applications** table click **Add +** and fill in:

| Field | Description |
| ----- | ----------- |
| **Application Name** | Must match **exactly** the Application ID defined in the TTN Console. The plugin uses this value to route outgoing requests to the correct TTN application. |
| **Device ID Prefix** | Prefix used when generating the device identifier; the Device EUI is appended automatically. Required for autoprovision. |

![Add application modal in TTN Thinger.io Plugin](assets/add_application.png)

Keep this page open—you will need the **Webhook URL** and the **TTN TOKEN** generated by the plugin in the next step.

---

## TTN Webhook Configuration

1. Log in to the **TTN Console** and select the target **Application**.  
2. Navigate to **Integrations → Webhooks** and click **Add Webhooks**.  
3. Choose **Thinger.io Template** and complete the form with the values shown in your plugin:

![TTN Webhook Settings for Thinger.io integration](assets/thinger_webhook.png)

| Template Field | Value |
|-----------|-----------------|
| **Webhook ID** | `Your prefered webhook id` |
| **Thinger.io instance** | `Your thinger.io instance domain e.g. acme.thinger.io or console.thinger.io` |
| **Thinger.io user** | `Your thinger.io username` |
| **Authoritation Header** | `Your thinger.io TTN API TOKEN` |
| **Plugin Endpoint** | `Plugin endpoint (leave default value if using this plugin)` |

> **Tip**
> You can find your **TTN API TOKEN** in the plugin settings page, under the **TTN API TOKEN** field,
> just click the "copy" button and paste it into the **Authoritation Header** field in the TTN Console.

![TTN Webhook Settings for Thinger.io integration](assets/ttn_api_token.png)

After saving, uplink traffic will appear in the plugin **Logs** panel.  
At this point the devices may still be unrecognised; autoprovision occurs once a matching **Device Template** is installed or created.

> Currently only **device uplinks** and **downlink confirmations** are handled. Gateway status messages are ignored.

More details on Webhooks can be found in the [The Things Stack documentation](https://www.thethingsindustries.com/docs/integrations/webhooks/).

---

## Device Templates

Device templates define:

* The expected data structure for an specific thinger product
* Uplink / downlink processing scripts  
* Default dashboards, device properties and data buckets

### Install a Device Template

Search the Marketplace for a template that matches your device model. If none exists, you can [create your own template](https://docs.thinger.io/products). Notice that, in Thinger.io, a **Product** is a template that defines the structure and behaviour of a device and can also be installed as a plugin.

> **Important**  
> Ensure the template **autoprovision prefix** matches the **Device ID Prefix** configured in the plugin.

---

## TTN Documentation

For more information about The Things Network and The Things Stack, please refer to the [official documentation](https://www.thethingsindustries.com/docs/).

---
