{
  "name": "imbuildings_imbuildings_moodbox",
  "version": "1.0.0",
  "description": "Get user feedback",
  "author": "Thinger.io",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/thinger-io/plugins.git",
    "directory": "imbuildings-imbuildings-moodbox"
  },
  "metadata": {
    "name": "Imbuildings IMBUILDINGS-MOODBOX",
    "description": "Get user feedback",
    "image": "assets/imbuildings-moodbox.png",
    "category": "devices",
    "vendor": "imbuildings"
  },
  "resources": {
    "products": [
      {
        "name": "Imbuildings IMBUILDINGS-MOODBOX",
        "description": "Get user feedback",
        "enabled": true,
        "product": "imbuildings_imbuildings_moodbox",

        "profile": {
          "api": {
            "uplink": {
              "enabled": true,
              "handle_connectivity": true,
              "device_id_resolver": "getId",
              "request": {
                "data": {
                  "payload": "{{payload}}",
                  "payload_type": "source_payload",
                  "resource_stream": "uplink",
                  "target": "resource_stream"
                }
              }
            },

            "downlink": {
              "enabled": true,
              "handle_connectivity": false,
              "request": {
                "data": {
                  "path": "/downlink",
                  "payload": "{\n  \"data\": \"{{payload.data=\"\"}}\",\n  \"port\": {{payload.port=10}},\n  \"priority\": {{payload.priority=3}},\n  \"confirmed\": {{payload.confirmed=false}},\n  \"uplink\": \"{{property.uplink}}\"\n}",
                  "plugin": "{{property.uplink.source}}",
                  "target": "plugin_endpoint"
                }
              }
            }
          },

          "autoprovisions": {
            "moodbox_autoprovisioning": {
              "enabled": true,
              "config": {
                "mode": "pattern",
                "pattern": "moodbox-.*"
              }
            }
          },

          "buckets": {
            "device_data": {
              "enabled": true,
              "backend": "mongodb",
              "retention": {
                "period": 6,
                "unit": "months"
              },
              "tags": [
                "button_feedback",
                "user_satisfaction"
              ],
              "data": {
                "payload": "{{payload}}",
                "payload_type": "source_payload",
                "payload_function": "parseButtonData",
                "resource": "uplink",
                "source": "resource",
                "update": "events"
              }
            }
          },

          "code": {
            "environment": "javascript",
            "version": "1.0",
            "storage": "",
            "code": "/* TU DECODER COMPLETO VA AQU√ç SIN CAMBIOS */"
          },

          "properties": {
            "uplink": {
              "enabled": true,
              "default": {
                "source": "value"
              },
              "data": {
                "payload": "{{payload}}",
                "payload_type": "source_payload",
                "resource": "uplink",
                "source": "resource",
                "update": "events"
              }
            }
          }
        }
      },

      {
  "name": "MoodBox",
  "placeholders": {
    "sources": []
  },
  "properties": {
    "background_image": "#1a1f2e"
  },
  "tabs": [
    {
      "name": "Button Feedback",
      "widgets": [
        {
          "layout": {
            "col": 0,
            "row": 0,
            "sizeX": 6,
            "sizeY": 8
          },
          "panel": {
            "color": "#1a2332",
            "currentColor": "#1a2332",
            "showFullscreen": true,
            "showOffline": {
              "type": "last_sample"
            },
            "subtitle": "User feedback over time",
            "title": "Button Presses (A-E)"
          },
          "properties": {
            "alignTimeSeries": false,
            "dataAppend": false,
            "options": "var options = {\n    series: series,\n    chart: {\n        type: 'bar',\n        toolbar: { show: true, autoSelected: 'zoom' },\n        zoom: { enabled: true, type: 'x', autoScaleYaxis: true }\n    },\n    plotOptions: {\n        bar: {\n            horizontal: false,\n            columnWidth: '55%',\n            dataLabels: { position: 'top' }\n        }\n    },\n    dataLabels: {\n        enabled: true,\n        style: { colors: ['#333'] }\n    },\n    stroke: { show: true, width: 2, colors: ['transparent'] },\n    xaxis: { type: 'datetime', labels: { datetimeUTC: false } },\n    yaxis: {\n        title: { text: 'Count' },\n        labels: { formatter: function(val) { return Math.floor(val); } }\n    },\n    fill: { opacity: 1 },\n    tooltip: {\n        x: { format: 'dd/MM/yyyy HH:mm' },\n        shared: true,\n        intersect: false\n    },\n    legend: { position: 'bottom' }\n};",
            "realTimeUpdate": true
          },
          "sources": [
            {
              "aggregation": {},
              "bucket": {
                "backend": "mongodb",
                "id": "device_data",
                "mapping": "button.a",
                "tags": {
                  "device": [],
                  "group": []
                }
              },
              "name": "Button A",
              "source": "bucket",
              "timespan": {
                "magnitude": "day",
                "mode": "relative",
                "period": "latest",
                "value": 7
              },
              "transform": "",
              "color": "#d11f1f"
            },
            {
              "aggregation": {},
              "bucket": {
                "backend": "mongodb",
                "id": "device_data",
                "mapping": "button.b",
                "tags": {
                  "device": [],
                  "group": []
                }
              },
              "name": "Button B",
              "source": "bucket",
              "timespan": {
                "magnitude": "day",
                "mode": "relative",
                "period": "latest",
                "value": 7
              },
              "transform": "",
              "color": "#25c5d0"
            },
            {
              "aggregation": {},
              "bucket": {
                "backend": "mongodb",
                "id": "device_data",
                "mapping": "button.c",
                "tags": {
                  "device": [],
                  "group": []
                }
              },
              "name": "Button C",
              "source": "bucket",
              "timespan": {
                "magnitude": "day",
                "mode": "relative",
                "period": "latest",
                "value": 7
              },
              "transform": "",
              "color": "#8cba36"
            },
            {
              "aggregation": {},
              "bucket": {
                "backend": "mongodb",
                "id": "device_data",
                "mapping": "button.d",
                "tags": {
                  "device": [],
                  "group": []
                }
              },
              "name": "Button D",
              "source": "bucket",
              "timespan": {
                "magnitude": "day",
                "mode": "relative",
                "period": "latest",
                "value": 7
              },
              "transform": "",
              "color": "#d3b522"
            },
            {
              "aggregation": {},
              "bucket": {
                "backend": "mongodb",
                "id": "device_data",
                "mapping": "button.e",
                "tags": {
                  "device": [],
                  "group": []
                }
              },
              "name": "Button E",
              "source": "bucket",
              "timespan": {
                "magnitude": "day",
                "mode": "relative",
                "period": "latest",
                "value": 7
              },
              "transform": "",
              "color": "#a44ac4"
            }
          ],
          "type": "apex_charts"
        },

        {
          "layout": {
            "col": 0,
            "row": 14,
            "sizeX": 6,
            "sizeY": 6
          },
          "panel": {
            "color": "#1a2332",
            "currentColor": "#1a2332",
            "showFullscreen": true,
            "showOffline": {
              "type": "last_sample"
            },
            "subtitle": "Device power status",
            "title": "Battery Voltage"
          },
          "properties": {
            "alignTimeSeries": false,
            "dataAppend": false,
            "options": "var options = {\n    series: series,\n    chart: {\n        type: 'line',\n        toolbar: { show: true, autoSelected: 'zoom' },\n        zoom: { enabled: true, type: 'x', autoScaleYaxis: true }\n    },\n    stroke: { curve: 'smooth', width: 2 },\n    xaxis: { type: 'datetime', labels: { datetimeUTC: false } },\n    yaxis: {\n        title: { text: 'Voltage (V)' },\n        labels: { formatter: function(val) { return val.toFixed(2) + ' V'; } },\n        min: 2.5,\n        max: 3.6\n    },\n    tooltip: {\n        x: { format: 'dd/MM/yyyy HH:mm' },\n        shared: true\n    },\n    legend: { position: 'bottom' },\n    annotations: {\n        yaxis: [\n            {\n                y: 2.8,\n                label: {\n                    style: { color: '#fff' },\n                    text: 'Low Battery'\n                }\n            }\n        ]\n    }\n};",
            "realTimeUpdate": true
          },
          "sources": [
            {
              "aggregation": {},
              "bucket": {
                "backend": "mongodb",
                "id": "device_data",
                "mapping": "battery_voltage",
                "tags": {
                  "device": [],
                  "group": []
                }
              },
              "color": "#30e12d",
              "name": "Battery",
              "source": "bucket",
              "timespan": {
                "magnitude": "day",
                "mode": "relative",
                "period": "latest",
                "value": 30
              },
              "transform": ""
            }
          ],
          "type": "apex_charts"
        },

        {
          "layout": {
            "col": 0,
            "row": 8,
            "sizeX": 6,
            "sizeY": 6
          },
          "panel": {
            "color": "#1a2332",
            "currentColor": "#1a2332",
            "showOffline": {
              "type": "none"
            },
            "title": "Device Status"
          },
          "properties": {
            "color": "#FFFFFF",
            "size": 24,
            "text": "Moodbox User Feedback Device\n\nMonitoring 5 button inputs (A-E) for user satisfaction tracking.\n\nData retention: 6 months\nUpdate interval: Event-driven",
            "unit": "",
            "unitpost": false,
            "val": ""
          },
          "sources": [
            {
              "bucket": {},
              "color": "#1abc9c",
              "name": "Source 1",
              "source": "bucket",
              "timespan": {
                "mode": "latest"
              }
            }
          ],
          "type": "text"
        }
      ]
    }
  ]
      }
    ]
  }
}
